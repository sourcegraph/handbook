# Accepted CVEs for Sourcegraph 4.0.1

| CVE ID                                                                      | Affected Images                                                                                                                                                                                                                                                                                                                                                     | CVE Severity | [Sourcegraph Assessment](../../../engineering/dev/policies/vulnerability-management-policy.md#severity-levels) | Details                                                                                                                                                                                                                                                                                                                                                                                                  |
| --------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------ | -------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [CVE-2021-23214](https://github.com/advisories/GHSA-467w-rrqc-395f)         | sourcegraph/server                                                                                                                                                                                                                                                                                                                                                  | High         | Info                                                                                                           | Some vulnerability scanners fingerprint this image as containing PostgreSQL 12.9, while the image actually contains 12.10. This finding is a false positive.                                                                                                                                                                                                                                             |
| [CVE-2021-32027](https://github.com/advisories/GHSA-8rj6-p58w-wpr2)         | sourcegraph/server                                                                                                                                                                                                                                                                                                                                                  | High         | Info                                                                                                           | Some vulnerability scanners fingerprint this image as containing PostgreSQL 12.7, while the image actually contains 12.10. This finding is a false positive.                                                                                                                                                                                                                                             |
| [CVE-2021-33194](https://nvd.nist.gov/vuln/detail/CVE-2021-33194)           | sourcegraph/grafana, sourcegraph/cadvisor, sourcegraph/server                                                                                                                                                                                                                                                                                                       | High         | Low                                                                                                            | The CVE affects HTML parsers, specifically the `ParseFragment` function. The affected dependencies don't [use the function](https://sourcegraph.com/search?q=context:global+repo:google/cadvisor%7Cgrafana/grafana%24+ParseFragment&patternType=lucky) nor [import the library](https://sourcegraph.com/search?q=context:global+repo:google/cadvisor%7Cgrafana/grafana%24+x/net/html&patternType=lucky). |
| [CVE-2021-38561](https://access.redhat.com/security/cve/CVE-2021-38561)     | sourcegraph/grafana, sourcegraph/cadvisor, sourcegraph/server                                                                                                                                                                                                                                                                                                       | High         | Info                                                                                                           | The CVE affects application parsing language tag using the affected library. [Neither of the Sourcegraph dependencies use `x/text` to parse arbitrary language tags](https://sourcegraph.com/search?q=context:global+repo:google/cadvisor%7Cgrafana/grafana%24+x/text&patternType=literal).                                                                                                              |
| [CVE-2021-44716](https://nvd.nist.gov/vuln/detail/CVE-2021-44716)           | sourcegraph/grafana, sourcegraph/cadvisor, sourcegraph/server                                                                                                                                                                                                                                                                                                       | High         | Low                                                                                                            | In certain conditions, the monitoring functionality packaged with Sourcegraph (Grafana and cAdvisor) could be rendered temporarily inoperable via specially crafted HTTP/2 requests. Exploiting this vulnerability requires administrator-level access, and does not affect the core Sourcegraph functionality. Sourcegraph does not consider this issue a viable security threat to the product.        |
| [CVE-2022-1552](https://www.postgresql.org/support/security/CVE-2022-1552/) | sourcegraph/server                                                                                                                                                                                                                                                                                                                                                  | High         | Info                                                                                                           | The vulnerability affects Postgres servers with multiple users where one user can bypass authorization controls and execute commands under a superuser identity. Sourcegraph runs Postgres with only the sg user, making the application not affected by this vulnerability.                                                                                                                             |
| [CVE-2022-2625](https://nvd.nist.gov/vuln/detail/CVE-2022-2625)             | sourcegraph/server                                                                                                                                                                                                                                                                                                                                                  | High         | Info                                                                                                           | Sourcegraph's default permissions model means it is not vulnerable to this issue.                                                                                                                                                                                                                                                                                                                        |
| [CVE-2022-2795](https://github.com/advisories/GHSA-9mq2-v988-m7mr)          | sourcegraph/frontend, sourcegraph/gitserver, sourcegraph/jaeger-all-in-one, sourcegraph/migrator, sourcegraph/postgres_exporter, sourcegraph/worker, sourcegraph/jaeger-agent, sourcegraph/repo-updater, sourcegraph/searcher, sourcegraph/syntax-highlighter, sourcegraph/github-proxy, sourcegraph/precise-code-intel-worker, sourcegraph/opentelemetry-collector | High         | Info                                                                                                           | A dependency bundled with Sourcegraph is vulnerable to denial of service attacks when configured in a specific way. Sourcegraph does not use this dependency in a way that renders it vulnerable to this issue.                                                                                                                                                                                          |
| [CVE-2022-2881](https://github.com/advisories/GHSA-gjh8-h6gp-pqgr)          | sourcegraph/frontend, sourcegraph/gitserver, sourcegraph/jaeger-all-in-one, sourcegraph/migrator, sourcegraph/postgres_exporter, sourcegraph/worker, sourcegraph/jaeger-agent, sourcegraph/repo-updater, sourcegraph/searcher, sourcegraph/syntax-highlighter, sourcegraph/github-proxy, sourcegraph/precise-code-intel-worker, sourcegraph/opentelemetry-collector | High         | Info                                                                                                           | Some scanners incorrectly report our images as affected by this CVE – we are running a version of the affected software (9.16) that is not affected by this issue.                                                                                                                                                                                                                                       |
| [CVE-2022-2906](https://github.com/advisories/GHSA-pqxc-54m5-8r8m)          | sourcegraph/frontend, sourcegraph/gitserver, sourcegraph/jaeger-all-in-one, sourcegraph/migrator, sourcegraph/postgres_exporter, sourcegraph/worker, sourcegraph/jaeger-agent, sourcegraph/repo-updater, sourcegraph/searcher, sourcegraph/syntax-highlighter, sourcegraph/github-proxy, sourcegraph/precise-code-intel-worker, sourcegraph/opentelemetry-collector | High         | Info                                                                                                           | Some scanners incorrectly report our images as affected by this CVE – we are running a version of the affected software (9.16) that is not affected by this issue.                                                                                                                                                                                                                                       |
| [CVE-2022-3080](https://github.com/advisories/GHSA-7mrh-jrcg-wc76)          | sourcegraph/frontend, sourcegraph/gitserver, sourcegraph/jaeger-all-in-one, sourcegraph/migrator, sourcegraph/postgres_exporter, sourcegraph/worker, sourcegraph/jaeger-agent, sourcegraph/repo-updater, sourcegraph/searcher, sourcegraph/syntax-highlighter, sourcegraph/github-proxy, sourcegraph/precise-code-intel-worker, sourcegraph/opentelemetry-collector | High         | Info                                                                                                           | A dependency bundled with Sourcegraph is vulnerable to denial of service attacks when configured in a specific way. Sourcegraph does not use this dependency in a way that renders it vulnerable to this issue.                                                                                                                                                                                          |
| [CVE-2022-21698](https://nvd.nist.gov/vuln/detail/CVE-2022-21698)           | sourcegraph/cadvisor, sourcegraph/grafana, sourcegraph/postgres_exporter, sourcegraph/server                                                                                                                                                                                                                                                                        | High         | Low                                                                                                            | The vulnerability affects several third party images shipped with Sourcegraph. However, it doesn't affect Sourcegraph services dirtectly and the third party services are not exposed via HTTP. Sourcegraph is not vulnerable to this vulnerability.                                                                                                                                                     |
| [CVE-2022-27191](https://nvd.nist.gov/vuln/detail/CVE-2022-27191)           | caddy, sourcegraph/grafana, sourcegraph/prometheus, sourcegraph/server, sourcegraph/postgres_exporter                                                                                                                                                                                                                                                               | High         | Info                                                                                                           | This vulnerability impacts SSH servers using the affected dependency. None of the affected images have ssh servers, much less using the dependency. Sourcegraph is not affected by this issue.                                                                                                                                                                                                           |
| [CVE-2022-27664](https://github.com/advisories/GHSA-69cg-p879-7622)         | sourcegraph/cadvisor, sourcegraph/prometheus, sourcegraph/grafana, sourcegraph/jaeger-all-in-one, sourcegraph/minio, sourcegraph/indexed-searcher, sourcegraph/server, caddy, sourcegraph/jaeger-agent, sourcegraph/search-indexer, sourcegraph/postgres_exporter, sourcegraph/node-exporter                                                                        | High         | Low                                                                                                            | This is a denial of service vulnerability that could affect the availability of Sourcegraph services in specific situations. As Sourcegraph is run as an internal service, our assessment of the severity of this issue is Low.                                                                                                                                                                          |
| [CVE-2022-37315](https://nvd.nist.gov/vuln/detail/CVE-2022-37315)           | sourcegraph/frontend, sourcegraph/gitserver, sourcegraph/migrator, sourcegraph/precise-code-intel-worker, sourcegraph/repo-updater, sourcegraph/searcher, sourcegraph/server, sourcegraph/sg, sourcegraph/symbols, sourcegraph/worker                                                                                                                               | High         | Info                                                                                                           | This issue does not affect our GraphQL API. Users are only allowed to fully control GraphQL requests through the API console, which [properly sanitizes the queries](https://sourcegraph.sourcegraph.com/github.com/sourcegraph/sourcegraph/-/blob/cmd/frontend/graphqlbackend/rate_limit.go?L54:34).                                                                                                    |
| [CVE-2022-38177](https://github.com/advisories/GHSA-5vfq-rv44-c5ff)         | sourcegraph/frontend, sourcegraph/gitserver, sourcegraph/jaeger-all-in-one, sourcegraph/migrator, sourcegraph/postgres_exporter, sourcegraph/worker, sourcegraph/jaeger-agent, sourcegraph/repo-updater, sourcegraph/searcher, sourcegraph/syntax-highlighter, sourcegraph/github-proxy, sourcegraph/precise-code-intel-worker, sourcegraph/opentelemetry-collector | High         | Info                                                                                                           | A dependency bundled with Sourcegraph is vulnerable to denial of service attacks when configured in a specific way. Sourcegraph does not use this dependency in a way that renders it vulnerable to this issue.                                                                                                                                                                                          |
| [CVE-2022-38178](https://github.com/advisories/GHSA-349w-cgp3-287r)         | sourcegraph/frontend, sourcegraph/gitserver, sourcegraph/jaeger-all-in-one, sourcegraph/migrator, sourcegraph/postgres_exporter, sourcegraph/worker, sourcegraph/jaeger-agent, sourcegraph/repo-updater, sourcegraph/searcher, sourcegraph/syntax-highlighter, sourcegraph/github-proxy, sourcegraph/precise-code-intel-worker, sourcegraph/opentelemetry-collector | High         | Info                                                                                                           | A dependency bundled with Sourcegraph is vulnerable to denial of service attacks when configured in a specific way. Sourcegraph does not use this dependency in a way that renders it vulnerable to this issue.                                                                                                                                                                                          |
| [CVE-2022-40674](https://github.com/advisories/GHSA-2vq2-xc55-3j5m)         | sourcegraph/cadvisor, sourcegraph/search-indexer                                                                                                                                                                                                                                                                                                                    | High         | Info                                                                                                           | This vulnerability affects a dependency of cAdvisor. cAdvisor itself does not use the vulnerable functionality, and is therefore not affected by the issue. It also affects our search-indexer image but Zoekt does not parse XML thus not being vulnerable to the issue.                                                                                                                                |
| [CVE-2021-43565](https://github.com/advisories/GHSA-gwc9-m7rh-j2ww)         | sourcegraph/server, sourcegraph/prometheus, sourcegraph/grafana, sourcegraph/postgres_exporter                                                                                                                                                                                                                                                                      | High         | Info                                                                                                           | This vulnerability is reported in dependencies included by Sourcegraph. Sourcegraph itself doesn't use the vulnerable functionality, and is therefore not affected by the issue.                                                                                                                                                                                                                         |
| [CVE-2022-37434](https://www.cve.org/CVERecord?id=CVE-2022-37434)           | caddy                                                                                                                                                                                                                                                                                                                                                               | High         | Low                                                                                                            | This vulnerability affects zlib, specifically the inflateGetHeader function. We use caddy as a reverse proxy and it does not process compressed files for Sourceraph. There is also no indication that caddy is vulnerable at all, similarly to NodeJS for the same vulnerability.                                                                                                                       |
