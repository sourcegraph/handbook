# Sourcegraph Cloud continuous delivery

This is a brief overview of the CD process for Sourcegraph Cloud (sourcegraph.com).

1. New commits pushed to the [monorepo](https://github.com/sourcegraph/sourcegraph) trigger builds by `buildkite`. The pipelines are all generated [from code](https://sourcegraph.com/github.com/sourcegraph/sourcegraph@main/-/tree/enterprise/dev/ci). The [Dev Experience Team](../../enablement/dev-experience/index.md) owns the Continuous Integration process. To learn more about the build pipelines and the methodology you can read the documentation on [continuous integration](https://docs.sourcegraph.com/dev/background-information/continuous_integration). A brief overview of the process is as follows:
   - On `main`, the pipeline will build candidate Docker images that are pushed to [Google Container Registry (internal)](https://console.cloud.google.com/gcr/images/sourcegraph-dev?project=sourcegraph-dev) with the tag format `<commit-hash>_<build-number>_candidate`. The pipeline will also run a suite of tests and checks.
   - If all pipeline steps pass the images are "promoted" and pushed to DockerHub with the tag format `<build-number>_<date>_<commit-hash>`.
2. [Renovate](https://github.com/sourcegraph/deploy-sourcegraph-dot-com/blob/release/renovate.json5) watches ([on a schedule](https://github.com/sourcegraph/deploy-sourcegraph-dot-com/blob/release/renovate.json5#L53)) DockerHub for new images. When a new image is found on DockerHub it creates a commit to the [Kubernetes manifests bases](https://github.com/sourcegraph/deploy-sourcegraph-dot-com/tree/release/base) with the new image tag and image hashes onto the `release` branch.
3. [The `deploy-sourcegraph-dot-com` Buildkite pipeline](https://github.com/sourcegraph/deploy-sourcegraph-dot-com/blob/release/.buildkite/pipeline.yaml#L27:L33) runs [`kubectl-apply-all.sh`](https://github.com/sourcegraph/deploy-sourcegraph-dot-com/blob/release/kubectl-apply-all.sh) with the updated manifests to roll out the new images.

[ArgoCD](https://argocd.sourcegraph.com/) watches the cluster and the latest images on DockerHub and verifies that the deployed images are currently the most up to date. Currently ArgoCD is only in watch-only mode and does not deploy images.
